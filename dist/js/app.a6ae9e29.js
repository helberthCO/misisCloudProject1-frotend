(()=>{"use strict";var e={5114:(e,t,n)=>{n(3792),n(3362),n(9085),n(9391);var r=n(3751),a=n(641);function s(e,t,n,r,s,o){var i=(0,a.g2)("RouterView");return(0,a.uX)(),(0,a.Wv)(i)}const o={name:"App"};var i=n(6262);const c=(0,i.A)(o,[["render",s]]),u=c;var l=n(5220),d=n(33),p={class:"login__container"},h={key:0,class:"error"},g={key:1,class:"error"},f={key:1,class:"login__register"};function m(e,t,n,s,o,i){var c=(0,a.g2)("Heading"),u=(0,a.g2)("Input"),l=(0,a.g2)("Button"),m=(0,a.g2)("RouterLink");return(0,a.uX)(),(0,a.CE)("div",p,[o.loginSuccess?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("form",{key:0,class:"login__sign-in",onSubmit:t[2]||(t[2]=(0,r.D$)((function(){return i.handleClick&&i.handleClick.apply(i,arguments)}),["prevent"]))},[(0,a.bF)(c,{tag:"h1",headingClass:"text--black font--medium"},{default:(0,a.k6)((function(){return t[3]||(t[3]=[(0,a.eW)("Inicia sesión")])})),_:1}),(0,a.bF)(u,{id:"username",label:"Nombre de usuario",modelValue:o.username,"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.username=e}),class:(0,d.C4)({error:o.invalidUser}),placeholder:"Ingresa tu nombre de usuario",required:""},null,8,["modelValue","class"]),o.invalidUser?((0,a.uX)(),(0,a.CE)("p",h,(0,d.v_)(o.invalidUserMessage),1)):(0,a.Q3)("",!0),(0,a.bF)(u,{id:"password",type:"password",label:"Contraseña",modelValue:o.password,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.password=e}),class:(0,d.C4)({error:o.invalidUser}),placeholder:"Ingresa tu contraseña",required:""},null,8,["modelValue","class"]),o.invalidUser?((0,a.uX)(),(0,a.CE)("p",g,(0,d.v_)(o.invalidUserMessage),1)):(0,a.Q3)("",!0),(0,a.bF)(l,{type:"submit"},{default:(0,a.k6)((function(){return t[4]||(t[4]=[(0,a.eW)("Ingresar")])})),_:1})],32)),o.loginSuccess?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",f,[(0,a.bF)(c,{tag:"h2",headingClass:"title text--white font--bold"},{default:(0,a.k6)((function(){return t[5]||(t[5]=[(0,a.eW)("Bienvenido!")])})),_:1}),(0,a.bF)(c,{tag:"h3",headingClass:"subtitle text--white font--regular"},{default:(0,a.k6)((function(){return t[6]||(t[6]=[(0,a.eW)("¿No tienes una cuenta?")])})),_:1}),(0,a.bF)(m,{to:"/register",class:"text--white"},{default:(0,a.k6)((function(){return t[7]||(t[7]=[(0,a.eW)("Registrate aquí")])})),_:1})]))])}var v=n(459),k=n(388);n(4114),n(6099);function b(e,t,n,r,s,o){return(0,a.uX)(),(0,a.Wv)((0,a.$y)(n.tag),{class:(0,d.C4)(n.headingClass)},{default:(0,a.k6)((function(){return[(0,a.RG)(e.$slots,"default",{},void 0,!0)]})),_:3},8,["class"])}const _={name:"Heading",props:{tag:{type:String,default:"h1"},headingClass:{type:String,default:""}}},x=(0,i.A)(_,[["render",b],["__scopeId","data-v-23e2962a"]]),y=x;var C={class:"input-wrapper"},w=["for"],E=["id","type","placeholder","value","required","minlength","accept","disabled"];function A(e,t,n,r,s,o){return(0,a.uX)(),(0,a.CE)("div",C,[n.label?((0,a.uX)(),(0,a.CE)("label",{key:0,for:n.id},(0,d.v_)(n.label),9,w)):(0,a.Q3)("",!0),(0,a.Lk)("input",{id:n.id,type:n.type,placeholder:n.placeholder,value:n.modelValue,required:n.required,minlength:n.minlength,accept:n.accept,disabled:n.notResponded,onInput:t[0]||(t[0]=function(){return o.onInput&&o.onInput.apply(o,arguments)}),onChange:t[1]||(t[1]=function(){return o.onChange&&o.onChange.apply(o,arguments)}),ref:"input"},null,40,E)])}n(2892);const I={name:"Input",props:{id:{type:String,default:null},type:{type:String,default:"text"},modelValue:{type:[String,Number],default:""},placeholder:{type:String,default:""},label:{type:String,default:""},required:{type:Boolean,default:!1},minlength:{type:Number,default:0},accept:{type:String,default:""},notResponded:{type:Boolean,default:!1}},methods:{onInput:function(e){this.$emit("update:modelValue",e.target.value)},onChange:function(e){"file"===this.type?this.$emit("update:modelValue",e.target.files[0]):this.$emit("update:modelValue",e.target.value)}}},F=(0,i.A)(I,[["render",A],["__scopeId","data-v-bf03223a"]]),S=F;var D=["id","type","disabled"];function R(e,t,n,r,s,o){return(0,a.uX)(),(0,a.CE)("button",{id:n.id,type:n.type,disabled:n.disabled,onClickOnce:t[0]||(t[0]=function(){return o.handleClick&&o.handleClick.apply(o,arguments)}),class:(0,d.C4)(n.buttonClass)},[(0,a.RG)(e.$slots,"default",{},void 0,!0)],42,D)}const U={name:"Button",props:{id:{type:String,default:null},type:{type:String,default:"button"},disabled:{type:Boolean,default:!1},buttonClass:{type:String,default:""}},methods:{handleClick:function(e){"submit"!==this.type&&e.preventDefault(),this.$emit("click",e)}}},L=(0,i.A)(U,[["render",R],["__scopeId","data-v-797c9cda"]]),B=L;var X=["href"];function W(e,t,n,r,s,o){var i=(0,a.g2)("RouterLink");return(0,a.uX)(),(0,a.CE)("div",null,[n.to?((0,a.uX)(),(0,a.Wv)(i,{key:0,to:n.to,class:(0,d.C4)(n.linkClass)},{default:(0,a.k6)((function(){return[(0,a.RG)(e.$slots,"default",{},void 0,!0)]})),_:3},8,["to","class"])):((0,a.uX)(),(0,a.CE)("a",{key:1,href:n.href,class:(0,d.C4)(n.linkClass)},[(0,a.RG)(e.$slots,"default",{},void 0,!0)],10,X))])}const O={name:"Link",components:{RouterLink:l.Wk},props:{to:{type:String,default:null},href:{type:String,default:"#"},linkClass:{type:String,default:""}}},V=(0,i.A)(O,[["render",W],["__scopeId","data-v-7022a710"]]),T=V;var M={NODE_ENV:"production",BASE_URL:"/"}.BACKEND_URL||"http://34.69.143.161";console.log("Backend URL: ".concat(M));const $={name:"Login",components:{Heading:y,Input:S,Button:B,Link:T},data:function(){return{username:"",password:"",loginSuccess:!1,invalidUser:!1,invalidUserMessage:""}},methods:{handleClick:function(e){var t=this;return(0,k.A)((0,v.A)().mark((function n(){var r,a,s;return(0,v.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.preventDefault(),r=new FormData,r.append("username",t.username),r.append("password",t.password),n.prev=4,n.next=7,fetch("".concat(M,"/accounts/login"),{method:"POST",body:r});case 7:return a=n.sent,n.next=10,a.json();case 10:s=n.sent,a.ok?(t.loginSuccess=!0,sessionStorage.setItem("token",s.token),t.$router.push("/")):(t.invalidUser=!0,t.invalidUserMessage=s.error),n.next=17;break;case 14:n.prev=14,n.t0=n["catch"](4),console.error("Error:",n.t0);case 17:case"end":return n.stop()}}),n,null,[[4,14]])})))()}}},H=(0,i.A)($,[["render",m],["__scopeId","data-v-edf45270"]]),j=H;var q={class:"register__container"},N={key:1,class:"register__fail"},z={key:2,class:"register__login"},P={key:3,class:"register__success"};function G(e,t,n,s,o,i){var c=(0,a.g2)("Heading"),u=(0,a.g2)("Input"),l=(0,a.g2)("Button"),p=(0,a.g2)("RouterLink");return(0,a.uX)(),(0,a.CE)("div",q,[o.registrationSuccess?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("form",{key:0,class:"register__form",onSubmit:t[3]||(t[3]=(0,r.D$)((function(){return i.handleRegister&&i.handleRegister.apply(i,arguments)}),["prevent"]))},[(0,a.bF)(c,{tag:"h1",headingClass:"text--primary font--bold"},{default:(0,a.k6)((function(){return t[4]||(t[4]=[(0,a.eW)("Bienvenido")])})),_:1}),(0,a.bF)(u,{id:"username",label:"Nombre de Usuario",modelValue:o.username,"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.username=e}),placeholder:"Ingres tu nombre de usuario",minlength:"4",required:""},null,8,["modelValue"]),(0,a.bF)(u,{id:"email",label:"Correo",modelValue:o.email,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.email=e}),placeholder:"Ingresa tu corrreo",minlength:"3",required:""},null,8,["modelValue"]),(0,a.bF)(u,{id:"password",type:"password",label:"Contraseña",modelValue:o.password,"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.password=e}),placeholder:"Ingresa tu contraseña",minlength:"8",required:""},null,8,["modelValue"]),(0,a.bF)(l,{type:"submit"},{default:(0,a.k6)((function(){return t[5]||(t[5]=[(0,a.eW)("Registrarse")])})),_:1})],32)),o.registrationFail?((0,a.uX)(),(0,a.CE)("div",N,[(0,a.bF)(c,{tag:"h5",headingClass:"subtitle text--red font--regular"},{default:(0,a.k6)((function(){return t[6]||(t[6]=[(0,a.eW)("Este usuario o correo ya han sido registrados, por favor intenta nuevamente.")])})),_:1})])):(0,a.Q3)("",!0),o.registrationSuccess?((0,a.uX)(),(0,a.CE)("div",P,[(0,a.bF)(c,{tag:"h2",headingClass:"text--primary font--bold"},{default:(0,a.k6)((function(){return[(0,a.eW)((0,d.v_)(o.successMessage),1)]})),_:1}),(0,a.bF)(p,{to:"/login"},{default:(0,a.k6)((function(){return t[9]||(t[9]=[(0,a.eW)("Inicia sesión aquí")])})),_:1})])):((0,a.uX)(),(0,a.CE)("div",z,[(0,a.bF)(c,{tag:"h3",headingClass:"subtitle text--primary font--regular"},{default:(0,a.k6)((function(){return t[7]||(t[7]=[(0,a.eW)("¿Ya tienes una cuenta?")])})),_:1}),(0,a.bF)(p,{to:"/login"},{default:(0,a.k6)((function(){return t[8]||(t[8]=[(0,a.eW)("Inicia sesión aquí")])})),_:1})]))])}n(6280),n(6918),n(739),n(3110);const Q={name:"Register",components:{Heading:y,Input:S,Button:B,Link:T},data:function(){return{username:"",email:"",password:"",registrationSuccess:!1,registrationFail:!1,successMessage:""}},methods:{handleRegister:function(e){var t=this;return(0,k.A)((0,v.A)().mark((function n(){var r,a;return(0,v.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.preventDefault(),r={username:t.username,email:t.email,password:t.password},n.prev=2,n.next=5,fetch("".concat(M,"/accounts"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 5:if(a=n.sent,a.ok){n.next=8;break}throw new Error("Network response was not ok");case 8:t.successMessage="¡Registro exitoso!",t.registrationSuccess=!0,n.next=15;break;case 12:n.prev=12,n.t0=n["catch"](2),t.registrationFail=!0;case 15:case"end":return n.stop()}}),n,null,[[2,12]])})))()}}},K=(0,i.A)(Q,[["render",G],["__scopeId","data-v-de9b22c8"]]),J=K;var Y={key:0,class:"home__logged-in"},Z={class:"file-container"},ee={key:1,class:"home__logged-out"};function te(e,t,n,r,s,o){var i=(0,a.g2)("Header"),c=(0,a.g2)("FileUploader"),u=(0,a.g2)("FileReader"),l=(0,a.g2)("ChatBox"),d=(0,a.g2)("Heading"),p=(0,a.g2)("RouterLink");return(0,a.uX)(),(0,a.CE)(a.FK,null,[r.isLoggedIn?((0,a.uX)(),(0,a.Wv)(i,{key:0,name:r.userName},null,8,["name"])):(0,a.Q3)("",!0),(0,a.Lk)("main",null,[r.isLoggedIn?((0,a.uX)(),(0,a.CE)("div",Y,[(0,a.Lk)("div",Z,[(0,a.bF)(c),(0,a.bF)(u)]),(0,a.bF)(l)])):((0,a.uX)(),(0,a.CE)("div",ee,[(0,a.bF)(d,{tag:"h1",headingClass:"home__logged-out__title text--primary font--bold"},{default:(0,a.k6)((function(){return t[0]||(t[0]=[(0,a.eW)("Bienvenido")])})),_:1}),(0,a.bF)(d,{tag:"h2",headingClass:"home__logged-out__subtitle text--black font--regular"},{default:(0,a.k6)((function(){return t[1]||(t[1]=[(0,a.eW)("¿Qué deseas hacer?")])})),_:1}),(0,a.bF)(p,{to:"/login",class:"home__logged-out__link font--bold"},{default:(0,a.k6)((function(){return t[2]||(t[2]=[(0,a.eW)("Iniciar sesión")])})),_:1}),(0,a.bF)(p,{to:"/register",class:"home__logged-out__link font--bold"},{default:(0,a.k6)((function(){return t[3]||(t[3]=[(0,a.eW)("Registrarte")])})),_:1})]))])],64)}var ne=n(953),re=(n(2010),{class:"header__container"}),ae={class:"header__username"},se={class:"font--bold"};function oe(e,t,n,r,s,o){return(0,a.uX)(),(0,a.CE)("header",re,[(0,a.Lk)("span",ae,[t[1]||(t[1]=(0,a.eW)("Hola, ")),(0,a.Lk)("span",se,(0,d.v_)(n.name),1)]),(0,a.Lk)("button",{onClick:t[0]||(t[0]=function(){return r.logout&&r.logout.apply(r,arguments)}),class:"header__logout-button"},"Cerrar sesión")])}const ie={name:"Header",props:{name:{type:String,required:!0}},setup:function(e){var t=(0,l.rd)(),n=function(){sessionStorage.removeItem("token"),t.push("/login")};return{logout:n}}},ce=(0,i.A)(ie,[["render",oe],["__scopeId","data-v-22be2ff7"]]),ue=ce;var le={class:"file-uploader__container"};function de(e,t,n,s,o,i){var c=(0,a.g2)("Heading"),u=(0,a.g2)("Input"),l=(0,a.g2)("Button");return(0,a.uX)(),(0,a.CE)("div",le,[(0,a.bF)(c,{tag:"h2",headingClass:"file-uploader__title text--primary font--bold"},{default:(0,a.k6)((function(){return t[5]||(t[5]=[(0,a.eW)("Subir Archivo")])})),_:1}),(0,a.Lk)("form",{onSubmit:t[4]||(t[4]=(0,r.D$)((function(){return i.uploadFile&&i.uploadFile.apply(i,arguments)}),["prevent"]))},[(0,a.Lk)("div",{class:(0,d.C4)({"drop-zone":!0,dragging:o.isDragging}),onDragover:t[0]||(t[0]=(0,r.D$)((function(){return i.onDragOver&&i.onDragOver.apply(i,arguments)}),["prevent"])),onDragenter:t[1]||(t[1]=(0,r.D$)((function(){return i.onDragEnter&&i.onDragEnter.apply(i,arguments)}),["prevent"])),onDragleave:t[2]||(t[2]=(0,r.D$)((function(){return i.onDragLeave&&i.onDragLeave.apply(i,arguments)}),["prevent"])),onDrop:t[3]||(t[3]=(0,r.D$)((function(){return i.onDrop&&i.onDrop.apply(i,arguments)}),["prevent"]))},[t[7]||(t[7]=(0,a.Lk)("p",null,"Arrastra y suelta el archivo aquí o",-1)),(0,a.bF)(u,{type:"file",ref:"fileInput",onChange:i.onFileChange,placeholder:i.filePlaceholder,accept:".pdf, .txt, .docx, .md, .doc"},null,8,["onChange","placeholder"]),(0,a.bF)(l,{type:"button",class:"trigger-file-button",onClick:i.triggerFileInput},{default:(0,a.k6)((function(){return t[6]||(t[6]=[(0,a.eW)("Selecciona un archivo")])})),_:1},8,["onClick"]),(0,a.Lk)("p",{class:(0,d.C4)({"file-name":!0,"file-name text--primary":o.fileUploaded})},(0,d.v_)(i.filePlaceholder),3)],34),(0,a.bF)(l,{type:"submit",class:"upload-file-button",disabled:!i.isFileSelected},{default:(0,a.k6)((function(){return t[8]||(t[8]=[(0,a.eW)("Subir archivo")])})),_:1},8,["disabled"])],32)])}n(8706),n(4423),n(8921),n(2062),n(1699),n(1454),n(6031);var pe=n(2543),he=n(7380),ge=(0,he.A)();const fe={name:"FileUploader",components:{Button:B,Input:S,Heading:y},data:function(){return{selectedFile:null,isDragging:!1,fileUploaded:!1,existingFiles:[]}},computed:{filePlaceholder:function(){return this.fileUploaded?"Archivo subido exitosamente":this.selectedFile?this.selectedFile.name:"Ningún archivo seleccionado"},isFileSelected:function(){return null!==this.selectedFile}},methods:{triggerFileInput:(0,pe.debounce)((function(){this.$refs.fileInput.$refs.input.click()}),300),onFileChange:function(e){this.selectedFile=e.target.files[0]},onDragOver:function(){this.isDragging=!0},onDragEnter:function(){this.isDragging=!0},onDragLeave:function(){this.isDragging=!1},onDrop:function(e){this.isDragging=!1;var t=e.dataTransfer.files,n=["application/pdf","text/plain","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/markdown"];if(t.length>0){var r=t[0];n.includes(r.type)?(this.selectedFile=r,this.$refs.fileInput.value=""):alert("Tipo de archivo no soportado. Solo se permiten archivos PDF, TXT, Word o Markdown.")}},uploadFile:function(){var e=this;return(0,k.A)((0,v.A)().mark((function t(){var n,r,a,s,o,i,c;return(0,v.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new FormData,r=sessionStorage.getItem("token"),t.next=4,e.fetchExistingFiles(r);case 4:a=e.selectedFile.name,s=a.substring(0,a.lastIndexOf(".")),o=a.substring(a.lastIndexOf(".")),i=1;while(e.existingFiles.includes(a))a="".concat(s,"-").concat(i).concat(o),i++;return n.append("file",e.selectedFile,a),t.prev=10,t.next=13,fetch("".concat(M,"/documents"),{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:n});case 13:if(c=t.sent,c.ok){t.next=16;break}throw new Error("Error al subir el archivo");case 16:e.fileUploaded=!0,ge.emit("file-uploaded"),setTimeout((function(){e.resetComponent()}),2e3),t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](10),console.log(t.t0.message);case 24:case"end":return t.stop()}}),t,null,[[10,21]])})))()},fetchExistingFiles:function(e){var t=this;return(0,k.A)((0,v.A)().mark((function n(){var r,a;return(0,v.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("".concat(M,"/accounts/documents"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});case 3:if(r=n.sent,r.ok){n.next=6;break}throw new Error("Error al obtener los archivos existentes");case 6:return n.next=8,r.json();case 8:a=n.sent,t.existingFiles=a.map((function(e){return e.name})),n.next=15;break;case 12:n.prev=12,n.t0=n["catch"](0),console.error(n.t0.message);case 15:case"end":return n.stop()}}),n,null,[[0,12]])})))()},resetComponent:function(){this.selectedFile=null,this.isDragging=!1,this.fileUploaded=!1}}},me=(0,i.A)(fe,[["render",de],["__scopeId","data-v-15021eca"]]),ve=me;var ke={class:"file-reader__container"},be={class:"file-reader__list"};function _e(e,t,n,r,s,o){var i=(0,a.g2)("Heading"),c=(0,a.g2)("Button");return(0,a.uX)(),(0,a.CE)("div",ke,[(0,a.bF)(i,{tag:"h2",headingClass:"file-reader__title text--primary font--bold"},{default:(0,a.k6)((function(){return t[0]||(t[0]=[(0,a.eW)("Archivos agregados")])})),_:1}),(0,a.Lk)("ul",be,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.documents,(function(e){return(0,a.uX)(),(0,a.CE)("li",{class:"file-reader__doc",key:e.id},[(0,a.Lk)("span",null,(0,d.v_)(e.name),1),(0,a.bF)(c,{class:"file-reader__delete",onClick:function(t){return o.deleteDocument(e.id)}},{default:(0,a.k6)((function(){return t[1]||(t[1]=[(0,a.eW)("Eliminar")])})),_:2},1032,["onClick"])])})),128))])])}n(2008),n(8992),n(4520);const xe={name:"FileReader",components:{Button:B,Heading:y},data:function(){return{documents:[]}},mounted:function(){this.fetchDocuments(),ge.on("file-uploaded",this.fetchDocuments)},beforeDestroy:function(){ge.off("file-uploaded",this.fetchDocuments)},methods:{fetchDocuments:function(){var e=this;return(0,k.A)((0,v.A)().mark((function t(){var n,r,a;return(0,v.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=sessionStorage.getItem("token"),t.prev=1,t.next=4,fetch("".concat(M,"/accounts/documents"),{method:"GET",headers:{Authorization:"Bearer ".concat(n)}});case 4:if(r=t.sent,r.ok){t.next=7;break}throw new Error("Error al obtener los documentos");case 7:return t.next=9,r.json();case 9:a=t.sent,e.documents=a,t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](1),console.error(t.t0.message);case 16:case"end":return t.stop()}}),t,null,[[1,13]])})))()},deleteDocument:function(e){var t=this;return(0,k.A)((0,v.A)().mark((function n(){var r,a;return(0,v.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=sessionStorage.getItem("token"),n.prev=1,n.next=4,fetch("".concat(M,"/documents/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify({documentID:e})});case 4:if(a=n.sent,a.ok){n.next=7;break}throw new Error("Error al eliminar el documento");case 7:t.documents=t.documents.filter((function(t){return t.id!==e})),n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](1),console.error(n.t0.message);case 13:case"end":return n.stop()}}),n,null,[[1,10]])})))()}}},ye=(0,i.A)(xe,[["render",_e],["__scopeId","data-v-9924d564"]]),Ce=ye;var we={class:"chat-box__container"},Ee={key:0,class:"chat-box__no-chats"},Ae={key:1,class:"chat-box__chats"};function Ie(e,t,n,s,o,i){var c=(0,a.g2)("Heading"),u=(0,a.g2)("messagesHandler"),l=(0,a.g2)("Button");return(0,a.uX)(),(0,a.CE)("div",we,[(0,a.bF)(c,{tag:"h2",headingClass:"chat-box__title text--primary font--bold"},{default:(0,a.k6)((function(){return t[1]||(t[1]=[(0,a.eW)("Chats")])})),_:1}),0===o.chats.length?((0,a.uX)(),(0,a.CE)("p",Ee,"No hay chats disponibles")):((0,a.uX)(),(0,a.CE)("div",Ae,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.chats,(function(e){return(0,a.uX)(),(0,a.CE)("div",{class:"chat-box__chat",key:e.id,style:(0,d.Tr)({order:e.id})},[(0,a.bF)(u,{chatId:e.id,messages:e.messages,sender:e.sender,onMessageSent:i.fetchChats},null,8,["chatId","messages","sender","onMessageSent"]),(0,a.bF)(l,{class:"chat-box__delete",onClickOnce:function(t){return i.deleteChat(e.id)}},{default:(0,a.k6)((function(){return t[2]||(t[2]=[(0,a.eW)("Eliminar Chat")])})),_:2},1032,["onClickOnce"])],4)})),128))])),(0,a.Lk)("form",{class:"chat-box__new-chat",onSubmit:t[0]||(t[0]=(0,r.D$)((function(){return i.createChat&&i.createChat.apply(i,arguments)}),["prevent"]))},[(0,a.bF)(l,{type:"submit"},{default:(0,a.k6)((function(){return t[3]||(t[3]=[(0,a.eW)("Crear un nuevo chat")])})),_:1})],32)])}n(7764),n(2953);var Fe={class:"messages-box__container"},Se={class:"messages-box__messages"},De={key:0,class:"messages-box__message messages-box__message--assistant messages-box__message--sending"};function Re(e,t,n,s,o,i){var c=(0,a.g2)("Input"),u=(0,a.g2)("Button");return(0,a.uX)(),(0,a.CE)("div",Fe,[(0,a.Lk)("div",Se,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.messages.RawMessage,(function(e,t){return(0,a.uX)(),(0,a.CE)("div",{key:t},[(0,a.Lk)("span",{class:(0,d.C4)(["messages-box__message","messages-box__message--".concat(e.sender)])},(0,d.v_)(e.text),3)])})),128)),o.notResponded?((0,a.uX)(),(0,a.CE)("span",De,t[2]||(t[2]=[(0,a.eW)("..."),(0,a.Lk)("span",{class:"dots"},null,-1)]))):(0,a.Q3)("",!0)]),(0,a.Lk)("form",{class:"messages-box__bubble",onSubmit:t[1]||(t[1]=(0,r.D$)((function(){return i.sendMessage&&i.sendMessage.apply(i,arguments)}),["prevent"]))},[(0,a.bF)(c,{class:"messages-box__input",type:"text",modelValue:o.message,"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.message=e}),notResponded:o.notResponded,placeholder:"Escribe un mensaje",required:""},null,8,["modelValue","notResponded"]),(0,a.bF)(u,{class:"messages-box__send",type:"submit",disabled:o.notResponded},{default:(0,a.k6)((function(){return t[3]||(t[3]=[(0,a.eW)(">")])})),_:1},8,["disabled"])],32)])}const Ue={name:"messagesHandler",components:{Input:S,Button:B},props:{chatId:{type:String,required:!0},messages:{type:Array,required:!0},sender:{type:String,required:!0}},data:function(){return{message:"",notResponded:!1,checkUnreadMessagesInterval:null}},methods:{sendMessage:function(){var e=this;return(0,k.A)((0,v.A)().mark((function t(){var n,r,a;return(0,v.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=sessionStorage.getItem("token"),r={text:e.message,sender:"user"},e.notResponded=!0,t.prev=3,t.next=6,fetch("".concat(M,"/chats/").concat(e.chatId,"/messages"),{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify(r)});case 6:a=t.sent,a.ok?(e.message="",e.$emit("message-sent"),e.startCheckingUnreadMessages()):console.error("Error al enviar el mensaje"),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](3),console.error("Error: ".concat(t.t0.message));case 13:case"end":return t.stop()}}),t,null,[[3,10]])})))()},startCheckingUnreadMessages:function(){this.checkUnreadMessagesInterval&&clearInterval(this.checkUnreadMessagesInterval),this.checkUnreadMessagesInterval=setInterval(this.checkUnreadMessages,1e3)},checkUnreadMessages:function(){var e=this;return(0,k.A)((0,v.A)().mark((function t(){var n,r,a;return(0,v.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=sessionStorage.getItem("token"),t.prev=1,t.next=4,fetch("".concat(M,"/chats/").concat(e.chatId,"/unread"),{method:"GET",headers:{Authorization:"Bearer ".concat(n)}});case 4:if(r=t.sent,!r.ok){t.next=10;break}return t.next=8,r.json();case 8:a=t.sent,a.unread?(e.notResponded=!1,e.$emit("message-sent"),e.markAsRead(),clearInterval(e.checkUnreadMessagesInterval)):e.notResponded=!0;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),console.error("Error: ".concat(t.t0.message));case 15:case"end":return t.stop()}}),t,null,[[1,12]])})))()},markAsRead:function(){var e=this;return(0,k.A)((0,v.A)().mark((function t(){var n;return(0,v.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=sessionStorage.getItem("token"),t.prev=1,t.next=4,fetch("".concat(M,"/chats/").concat(e.chatId,"/mark-as-read"),{method:"POST",headers:{Authorization:"Bearer ".concat(n)}});case 4:t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](1),console.error("Error: ".concat(t.t0.message));case 10:case"end":return t.stop()}}),t,null,[[1,7]])})))()}},beforeDestroy:function(){this.checkUnreadMessagesInterval&&clearInterval(this.checkUnreadMessagesInterval)}},Le=(0,i.A)(Ue,[["render",Re],["__scopeId","data-v-46b9d902"]]),Be=Le,Xe={name:"ChatBox",components:{Heading:y,Button:B,messagesHandler:Be},data:function(){return{chats:[]}},mounted:function(){this.fetchChats()},methods:{fetchChats:function(){var e=this;return(0,k.A)((0,v.A)().mark((function t(){var n,r,a,s;return(0,v.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=sessionStorage.getItem("token"),t.prev=1,t.next=4,fetch("".concat(M,"/accounts/chats"),{method:"GET",headers:{Authorization:"Bearer ".concat(n)}});case 4:if(r=t.sent,!r.ok){t.next=13;break}return t.next=8,r.json();case 8:return a=t.sent,t.next=11,Promise.all(a.map(function(){var e=(0,k.A)((0,v.A)().mark((function e(t){var r,a;return(0,v.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(M,"/chats/").concat(t.id),{method:"GET",headers:{Authorization:"Bearer ".concat(n)}});case 2:if(r=e.sent,!r.ok){e.next=9;break}return e.next=6,r.json();case 6:return a=e.sent,t.messages=a.messages,e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:s=t.sent,e.chats=s;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](1),console.error("Error: ".concat(t.t0.message));case 18:case"end":return t.stop()}}),t,null,[[1,15]])})))()},createChat:function(){var e=this;return(0,k.A)((0,v.A)().mark((function t(){var n,r;return(0,v.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=sessionStorage.getItem("token"),t.prev=1,t.next=4,fetch("".concat(M,"/chats"),{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});case 4:r=t.sent,r.ok?e.fetchChats():console.error("Error al crear el chat"),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.error("Error: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},deleteChat:function(e){var t=this;return(0,k.A)((0,v.A)().mark((function n(){var r,a;return(0,v.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=sessionStorage.getItem("token"),n.prev=1,n.next=4,fetch("".concat(M,"/chats/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}});case 4:a=n.sent,a.ok?t.fetchChats():console.error("Error al eliminar el chat"),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](1),console.error("Error: ".concat(n.t0.message));case 11:case"end":return n.stop()}}),n,null,[[1,8]])})))()}}},We=(0,i.A)(Xe,[["render",Ie],["__scopeId","data-v-1349498c"]]),Oe=We,Ve={name:"HomeView",components:{Heading:y,Header:ue,FileUploader:ve,FileReader:Ce,ChatBox:Oe},setup:function(){var e=(0,ne.KR)(!1),t=(0,l.rd)(),n=(0,ne.KR)(""),r=function(){var e=(0,k.A)((0,v.A)().mark((function e(t){var r,a;return(0,v.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(M,"/accounts"),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 3:return r=e.sent,e.next=6,r.json();case 6:a=e.sent,r.ok?n.value=a.username:console.error("Error:",a.error),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),console.error("Error:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();(0,a.sV)((function(){var t=sessionStorage.getItem("token");t&&(e.value=!0,r(t))}));var s=function(){sessionStorage.removeItem("token"),e.value=!1,t.push("/login")};return{isLoggedIn:e,userName:n,logout:s}}},Te=(0,i.A)(Ve,[["render",te],["__scopeId","data-v-f8733b06"]]),Me=Te;var $e=[{path:"/",name:"home",component:Me},{path:"/login",name:"login",component:j},{path:"/register",name:"register",component:J}],He=(0,l.aE)({history:(0,l.LA)(),routes:$e});const je=He;var qe=(0,r.Ef)(u);qe.use(je),qe.mount(".app")}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=e,(()=>{var e=[];n.O=(t,r,a,s)=>{if(!r){var o=1/0;for(l=0;l<e.length;l++){for(var[r,a,s]=e[l],i=!0,c=0;c<r.length;c++)(!1&s||o>=s)&&Object.keys(n.O).every((e=>n.O[e](r[c])))?r.splice(c--,1):(i=!1,s<o&&(o=s));if(i){e.splice(l--,1);var u=a();void 0!==u&&(t=u)}}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[r,a,s]}})(),(()=>{n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{var e={524:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var a,s,[o,i,c]=r,u=0;if(o.some((t=>0!==e[t]))){for(a in i)n.o(i,a)&&(n.m[a]=i[a]);if(c)var l=c(n)}for(t&&t(r);u<o.length;u++)s=o[u],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(l)},r=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n.O(void 0,[504],(()=>n(5114)));r=n.O(r)})();
//# sourceMappingURL=app.a6ae9e29.js.map